<!DOCTYPE html>
<html lang="ru" data-theme="">
<head>
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Онлайн‑уроки | Запись на уроки по математике и физике</title>
  <meta name="description" content="Онлайн‑запись на индивидуальные уроки по математике и физике. Урок — 50 минут.">
  <link rel="canonical" href="https://tutoravv.github.io/">

  <link rel="icon" href="favicon.svg" type="image/svg+xml" sizes="any">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="manifest" href="site.webmanifest">
  <link rel="mask-icon" href="safari-pinned-tab.svg" color="#6366f1">
  <meta name="theme-color" content="#0b1020">
  <meta name="msapplication-TileColor" content="#0b1020">

  <meta property="og:type" content="website">
  <meta property="og:locale" content="ru_RU">
  <meta property="og:site_name" content="Онлайн‑уроки">
  <meta property="og:title" content="Онлайн‑уроки по математике и физике">
  <meta property="og:description" content="Запишитесь на удобное время. Урок — 50 минут.">
  <meta property="og:url" content="https://tutoravv.github.io/">
  <meta property="og:image" content="https://tutoravv.github.io/og-image.png">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --wrap: 1140px;
      --bg:#0b1020; --text:#e5e7eb; --muted:#9aa5b1; --card:rgba(255,255,255,0.06);
      --border:rgba(255,255,255,0.12); --ring:rgba(99,102,241,0.5);
      --shadow: 0 12px 32px rgba(0,0,0,0.35);
      --btn-grad: linear-gradient(135deg, #6366f1, #8b5cf6);
      color-scheme: dark;
    }
    [data-theme="light"]{
      --bg:#f8fafc; --text:#0f172a; --muted:#475569; --card:#ffffff;
      --border:#e5e7eb; --ring:rgba(99,102,241,0.2);
      --shadow: 0 10px 30px rgba(2,6,23,0.08);
      color-scheme: light;
    }

    *{box-sizing:border-box}
    html,body{height:100%}

    /* Фон: единый фиксированный градиент */
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif; color:var(--text);
      background: var(--bg);
      position: relative;
      overflow-x: hidden;
      transition: background-color .2s ease, color .2s ease;
    }
    body::before{
      content:"";
      position: fixed;
      inset:-40vh -40vw -40vh -40vw;
      z-index:-1;
      pointer-events:none;
      background:
        radial-gradient(60% 40% at 120% -10%, rgba(99,102,241,.12), transparent 60%),
        radial-gradient(45% 30% at -10% 120%, rgba(37,99,235,.10), transparent 60%);
      background-repeat:no-repeat;
      background-size:100% 100%;
    }

    header,section,footer{max-width:var(--wrap);margin:0 auto;padding:20px}
    .padless{padding-left:0; padding-right:0}

    header{
      position:sticky; top:0; z-index:10;
      background: color-mix(in srgb, var(--bg) 92%, transparent);
      backdrop-filter: blur(8px);
      display:flex; align-items:center; justify-content:space-between; gap:14px; flex-wrap:wrap;
      border-bottom:1px solid var(--border)
    }
    .brand{font-weight:800; letter-spacing:.2px}
    nav{display:flex; align-items:center; gap:16px}
    nav a{color:var(--text); text-decoration:none; font-weight:600}

    .toggle{
      display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border:1px solid var(--border);
      border-radius:10px; background:var(--card); color:var(--text); cursor:pointer; font-weight:600;
      box-shadow: var(--shadow); transition:transform .12s ease;
    }
    .toggle:hover{transform:translateY(-1px)}
    .toggle svg{width:18px;height:18px}

    .btn{
      display:inline-flex; align-items:center; gap:8px;
      background:var(--btn-grad); color:#fff; padding:12px 18px; border-radius:12px; text-decoration:none !important;
      font-weight:700; border:0; cursor:pointer; box-shadow:0 8px 24px rgba(99,102,241,.25);
      transition:transform .12s ease, box-shadow .12s ease; font-size:16px; line-height:1;
    }
    .btn:hover{transform:translateY(-1px); box-shadow:0 12px 28px rgba(99,102,241,.35)}
    .btn:disabled{opacity:.7; cursor:not-allowed}
    /* Ghost: в тёмной теме — прозрачные (как раньше), в светлой — белые */
    .btn.ghost{ background:transparent; color:var(--text); border:1px solid var(--border); box-shadow:none }
    [data-theme="light"] .btn.ghost{ background:#fff; }

    .btn.tg{ background:#0088cc }

    .card{
      background: linear-gradient(135deg, rgba(99,102,241,.10), rgba(16,185,129,.10));
      padding:24px; border-radius:16px; border:1px solid var(--border); box-shadow: var(--shadow)
    }
    section.card{ margin-top:16px }

    .grid{display:grid; gap:16px}
    .two{grid-template-columns:1fr 1fr}
    @media(max-width:820px){.two{grid-template-columns:1fr}}

    label{font-weight:600;font-size:14px;margin-bottom:6px;display:block}
    input,select{
      width:100%; padding:12px 14px; border:1px solid var(--border); border-radius:12px; color:var(--text);
      background:var(--card); outline:none; transition:border-color .15s, box-shadow .15s; font-size:15px;
    }
    input:focus,select:focus{border-color:#7c83ff; box-shadow:0 0 0 6px var(--ring)}
    input::placeholder{ color:var(--muted); opacity:.9 }

    select{
      appearance:none; -webkit-appearance:none; -moz-appearance:none;
      padding-right:40px; position:relative;
      background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23a5b4fc'%3E%3Cpath d='M5.5 7.5l4.5 4.5 4.5-4.5'/%3E%3C/svg%3E");
      background-repeat:no-repeat; background-position:right 12px center; background-size:16px 16px;
    }
    [data-theme="light"] select{
      background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%236366f1'%3E%3Cpath d='M5.5 7.5l4.5 4.5 4.5-4.5'/%3E%3C/svg%3E");
    }
    select option{ background-color:#111827; color:#e5e7eb }
    [data-theme="light"] select option{ background-color:#fff; color:#0f172a }
    select:disabled{ opacity:.6; cursor:not-allowed }

    .muted{color:var(--muted);font-size:14px}
    .muted.form-note{ margin-top:6px; display:block } /* подпись под телефоном */

    .loading{display:inline-flex; align-items:center; gap:10px; color:var(--muted); font-size:14px}
    .spinner{width:16px; height:16px; border-radius:50%; border:2px solid var(--border); border-top-color:#7c83ff; animation:spin .8s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    .success{background:#064e3b; color:#d1fae5; padding:12px; border-radius:12px}
    [data-theme="light"] .success{ background:#ecfdf5; color:#065f46 }
    .error{background:#7f1d1d; color:#fee2e2; padding:12px; border-radius:12px}
    [data-theme="light"] .error{ background:#fee2e2; color:#991b1b }

    h1,h2{letter-spacing:.2px;margin:0 0 10px}
    footer{ text-align:center; color:var(--muted) }

    .formCard{ display:grid; grid-template-columns: 1fr 1.05fr; gap:24px; align-items:stretch }
    @media(max-width:900px){ .formCard{ grid-template-columns:1fr } }

    .media{ min-height:460px; background:none; position:relative; }
    .media img{ width:100%; height:100%; object-fit:contain; display:block; }

    .actions{ display:flex; align-items:center; justify-content:center; gap:16px; margin-top:6px }
    #status{ min-height:20px }

    .confirm{
      grid-column: 1 / -1;
      margin-top: 12px;
      padding:20px; border-radius:16px; border:1px solid var(--border);
      background: linear-gradient(135deg, rgba(16,185,129,.12), rgba(99,102,241,.12));
      box-shadow: var(--shadow);
    }
    .confirm.hidden{ display:none }
    .confirm-icon{ font-size:28px }
    .confirm-title{ font-weight:800; font-size:20px; margin-top:8px }
    .confirm-when{ font-weight:700; margin-top:4px }
    .confirm-tags{ display:flex; gap:8px; margin-top:8px; flex-wrap:wrap }
    .tag{
      display:inline-block; padding:6px 10px; border-radius:999px; font-weight:700; font-size:13px;
      border:1px solid var(--border); background: color-mix(in srgb, var(--card) 70%, transparent);
    }
    .confirm-note{ margin-top:10px; color:var(--muted) }
    .confirm-actions{ display:flex; gap:10px; margin-top:14px; flex-wrap:wrap }

    @media(max-width:820px){ .media{ display:none } }

    /* Красивое интро */
    .intro{
      max-width:760px;
      margin:0;
      color:var(--muted);
      line-height:1.75;
      font-size:16px;
    }
    .intro .intro-title{
      display:block;
      color:var(--text);
      font-weight:800;
      font-size:18px;
      margin-bottom:6px;
    }
    .intro .intro-text{ display:block; margin-top:6px; }
  </style>
</head>
<body>
<header>
  <div class="brand">Онлайн‑уроки</div>
  <nav>
    <a href="#schedule">Запись</a>
    <a href="#contacts">Контакты</a>
    <button id="themeToggle" class="toggle" type="button" aria-pressed="false" title="Переключить тему">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.36 6.36-1.42-1.42M7.05 7.05 5.64 5.64m12.02 0-1.41 1.41M7.05 16.95l-1.41 1.41"/>
        <circle cx="12" cy="12" r="4"/>
      </svg>
      <span id="themeLabel">Тёмная тема</span>
    </button>
  </nav>
</header>

<section class="card">
  <h1>Онлайн‑уроки по математике и физике</h1>
  <p class="intro">
    <span class="intro-title">Математика и физика — без пробелов</span>
    <span class="intro-text">Помогаю подтянуть оценки, разобраться в сложных темах и полюбить предметы.</span>
    <span class="intro-text">Индивидуальные занятия для 4 – 9 классов, урок — 50 минут.</span>
  </p>
  <p><a class="btn" href="#schedule">Записаться</a></p>
</section>

<section id="schedule" class="padless">
  <h2 style="padding:0 20px">Запись на занятие</h2>

  <div class="card formCard">
    <div class="media" aria-hidden="true">
      <img id="heroImg" src="https://tutoravv.github.io/heroImg.png" alt="">
    </div>

    <!-- ФОРМА -->
    <form id="bookingForm" class="grid" autocomplete="on">
      <div class="two grid">
        <div>
          <label for="name">Фамилия Имя</label>
          <input id="name" name="name" required placeholder="Иванов Иван">
        </div>
        <div>
          <label for="email">Email</label>
          <input id="email" name="email" type="email" required placeholder="name@example.com">
        </div>
      </div>

      <div>
        <label for="phone">Телефон</label>
        <input id="phone" name="phone" type="tel" required placeholder="+7 999 123‑45‑67">
        <div class="muted form-note">Телефон и e‑mail — для связи и напоминаний.</div>
      </div>

      <div>
        <label for="subject">Предмет</label>
        <select id="subject" name="subject">
          <option>Математика</option>
          <option>Физика</option>
        </select>
      </div>

      <div class="two grid">
        <div>
          <label for="date">Дата занятия</label>
          <input id="date" name="date" type="date" required>
        </div>
        <div>
          <label for="time">Время слота (МСК)</label>
          <select id="time" name="time" required disabled></select>
        </div>
      </div>

      <div class="actions">
        <button class="btn" type="submit">Записаться на занятие</button>
      </div>
      <div id="status" aria-live="polite"></div>
    </form>

    <!-- Персистентная карточка подтверждения -->
    <div id="confirmCard" class="confirm hidden" role="status" aria-live="polite">
      <div class="confirm-icon">✅</div>
      <div class="confirm-title">Вы записаны!</div>
      <div class="confirm-when" id="confirmWhen"></div>
      <div class="confirm-tags">
        <span class="tag" id="confirmSubject"></span>
        <span class="tag">50 минут</span>
      </div>
      <div class="confirm-note" id="confirmNote"></div>
      <div class="confirm-actions">
        <a id="btnOpenTG" class="btn tg" target="_blank" rel="noopener">Открыть в Telegram</a>
        <button id="btnCopyTG" class="btn ghost" type="button">Скопировать ссылку</button>
        <button id="btnNew" class="btn ghost" type="button">Новая запись</button>
      </div>
    </div>
  </div>
</section>

<section id="contacts" class="padless">
  <h2 style="padding:0 20px">Контакты</h2>
  <div class="card">
    <p><a class="btn tg" href="https://t.me/aviation09" target="_blank" rel="noopener">Связаться в Telegram</a></p>
  </div>
</section>

<footer>
  <small>© 2025 Онлайн‑уроки. Все права защищены</small>
</footer>

<script>
  const GAS_URL = 'https://script.google.com/macros/s/AKfycbyP6xb2-6wRY2CwEQ8jZV_mLURRvH1aU9LvX-BIxPONEcNPqSwdQxTKDsL-9pVr09d4/exec';

  // Тема
  const themeBtn = document.getElementById('themeToggle');
  const themeLabel = document.getElementById('themeLabel');
  initTheme();
  function initTheme(){
    const saved = localStorage.getItem('theme');
    const systemDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = saved || (systemDark ? 'dark' : 'light');
    setTheme(theme);
  }
  function setTheme(mode){
    document.documentElement.setAttribute('data-theme', mode);
    localStorage.setItem('theme', mode);
    const isDark = mode !== 'light';
    themeBtn.setAttribute('aria-pressed', isDark ? 'true' : 'false');
    themeLabel.textContent = isDark ? 'Тёмная тема' : 'Светлая тема';
    themeBtn.querySelector('svg').innerHTML = isDark
      ? '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z"></path>'
      : '<path d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.36 6.36-1.42-1.42M7.05 7.05 5.64 5.64m12.02 0-1.41 1.41M7.05 16.95l-1.41 1.41"></path><circle cx="12" cy="12" r="4"></circle>';
  }
  themeBtn.addEventListener('click', () => {
    const current = document.documentElement.getAttribute('data-theme') || 'dark';
    setTheme(current === 'light' ? 'dark' : 'light');
  });

  // Элементы формы/карточки
  const dateEl = document.getElementById('date');
  const timeEl = document.getElementById('time');
  const statusEl = document.getElementById('status');
  const emailEl = document.getElementById('email');
  const phoneEl = document.getElementById('phone');
  const subjectEl = document.getElementById('subject');

  const confirmCard = document.getElementById('confirmCard');
  const confirmWhen = document.getElementById('confirmWhen');
  const confirmSubject = document.getElementById('confirmSubject');
  const confirmNote = document.getElementById('confirmNote');
  const btnOpenTG = document.getElementById('btnOpenTG');
  const btnCopyTG = document.getElementById('btnCopyTG');
  const btnNew = document.getElementById('btnNew');

  let statusLockUntil = 0;

  function todayMskYmd() {
    const fmt = new Intl.DateTimeFormat('en-CA', { timeZone: 'Europe/Moscow', year:'numeric', month:'2-digit', day:'2-digit' });
    return fmt.format(new Date());
  }
  dateEl.min = todayMskYmd();
  initDate();

  async function initDate() {
    try {
      const res = await fetch(`${GAS_URL}?action=nextOpenDate`);
      const data = await res.json();
      dateEl.value = (data.ok && data.date) ? data.date : todayMskYmd();
    } catch {
      dateEl.value = todayMskYmd();
    }
    populateTimes();
  }

  dateEl.addEventListener('change', populateTimes);

  async function populateTimes() {
    timeEl.innerHTML = '';
    timeEl.disabled = true;
    const ymd = dateEl.value;
    if (!ymd) return;
    showLoading('Загружаем слоты…');

    try {
      const res = await fetch(`${GAS_URL}?action=slots&date=${encodeURIComponent(ymd)}`);
      const data = await res.json();
      if (!data.ok) throw new Error(data.error || 'ошибка');

      if (!data.slots || data.slots.length === 0) {
        showStatus('На выбранную дату слоты отсутствуют.', 'error'); return;
      }

      for (const s of data.slots) {
        const opt = document.createElement('option');
        opt.value = s.startIso;
        opt.textContent = s.label;
        timeEl.appendChild(opt);
      }
      timeEl.disabled = false;
      showStatus('', '');
    } catch (e) {
      console.error(e);
      showStatus('Не удалось загрузить слоты. Обновите страницу позже.', 'error');
    }
  }

  function normalizePhoneLocal(s){
    const digits = String(s||'').replace(/\D/g,'');
    if (!digits) return '';
    let d = digits;
    if (d.length === 11 && d.startsWith('8')) d = '7' + d.slice(1);
    return '+' + d;
  }

  document.getElementById('bookingForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    showLoading('Отправляем запрос…');

    const name = document.getElementById('name').value.trim();
    const email = emailEl.value.trim();
    const phoneRaw = phoneEl.value.trim();
    const phone = normalizePhoneLocal(phoneRaw);
    const subject = subjectEl.value.trim();
    const startIso = timeEl.value;

    if (!startIso) { showStatus('Выберите время слота', 'error'); return; }
    if (!email) { showStatus('Укажите email.', 'error'); return; }
    if (!phone) { showStatus('Укажите телефон в формате +7…', 'error'); return; }

    const channel = 'email';
    const payload = { name, email, subject, startIso, channel, phone };
    try {
      const res = await fetch(GAS_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
        body: JSON.stringify(payload)
      });
      const data = await res.json();

      if (!data.ok) {
        const map = { busy:'Этот слот уже занят. Пожалуйста, выберите другой.', past:'Нельзя записаться на прошедшее время.', closed:'Слот недоступен. Выберите другое время.' };
        showStatus(map[data.reason] || ('Ошибка: ' + (data.error || 'неизвестно')), 'error'); return;
      }

      const start = new Date(data.startIso);
      const mskLabel = start.toLocaleString('ru-RU', {
        timeZone: 'Europe/Moscow', year: 'numeric', month: '2-digit', day: '2-digit',
        hour: '2-digit', minute: '2-digit', hourCycle: 'h23'
      });

      renderConfirm({
        when: mskLabel,
        subject,
        tme: data.tme || '',
        channel: data.channel || channel,
        email
      });

    } catch (err) {
      console.error(err);
      showStatus('Не удалось отправить заявку. Проверьте интернет и попробуйте снова.', 'error');
    }
  });

  function renderConfirm({ when, subject, tme, channel, email }){
    confirmWhen.textContent = `${when} МСК`;
    confirmSubject.textContent = subject || 'Занятие';

    let note = `Приглашение отправлено на ${email}.`;
    note += tme ? ' Чтобы получать напоминания в Telegram — активируйте бота.' : '';
    confirmNote.textContent = note;

    if (tme) {
      btnOpenTG.href = tme;
      btnOpenTG.classList.remove('hidden');
      btnCopyTG.onclick = () => {
        navigator.clipboard.writeText(tme).then(()=>{
          btnCopyTG.textContent='Ссылка скопирована';
          setTimeout(()=>btnCopyTG.textContent='Скопировать ссылку',1800);
        });
      };
      btnCopyTG.disabled = false;
    } else {
      btnOpenTG.removeAttribute('href');
      btnOpenTG.classList.add('hidden');
      btnCopyTG.onclick = null;
      btnCopyTG.disabled = true;
    }

    btnNew.onclick = () => {
      document.getElementById('bookingForm').reset();
      populateTimes();
      emailEl.focus();
    };

    confirmCard.classList.remove('hidden');
    // Симпатичнее статус: галочка + краткие детали
    showStatus(`✅ Готово! Бронирование создано • ${subject || 'Занятие'} • ${when} МСК`, 'success', { stickyMs: 15000 });
  }

  function showLoading(text){
    if (Date.now() < statusLockUntil) return;
    statusEl.className = 'loading';
    statusEl.innerHTML = `<span class="spinner" aria-hidden="true"></span><span>${text}</span>`;
  }
  function showStatus(html, type, opts) {
    opts = opts || {};
    if (!html) {
      if (Date.now() < statusLockUntil) return;
      statusEl.className = '';
      statusEl.innerHTML = '';
      return;
    }
    statusEl.className = type === 'error' ? 'error' : (type === 'success' ? 'success' : '');
    statusEl.innerHTML = html;
    if (opts.stickyMs) statusLockUntil = Date.now() + opts.stickyMs;
  }
</script>
</body>
</html>










